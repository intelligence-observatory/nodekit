<!-- example.html -->
<!doctype html>
<html lang="en">
<head>
    <link rel="shortcut icon" href="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>NodeKit Browser</title>
</head>
<body>
<div id="app"></div>
<script type="module" src="src/main.ts"></script>
<script type="module">

    const choiceCardsTmp = {
        "hello-image": {
            "card_type": "ImageCard",
            "region": {
                "x": -0.1,
                "y": 0,
                "w": 0.4,
                "h": 0.2,
                "mask": 'rectangle',
            },
            "image": {
                "sha256": 'yo',
                "media_type": "image/png",
                "locator": {
                    "locator_type": 'RelativePath',
                    "relative_path": "./assets/image/png/f66018c63e5de97a4a022f8d0da2083d44a842abcc27195b6cca13980a77dc7b.png"
                }
            },
            "font_size": 0.03,
            "justification_horizontal": "center",
            "justification_vertical": "center",
            "text_color": "#000000ff",
            "background_color": "#e6e6e6ff"
        },
        "hello-text": {
            "card_type": "TextCard",
            "region": {
                "x": -0.4,
                "y": -0.4,
                "w": 0.2,
                "h": 0.1,
                "mask": 'rectangle',
            },
            "text": "I am a TextCard.",
            "font_size": 0.03,
            "justification_horizontal": "center",
            "justification_vertical": "center",
            "text_color": "#000000ff",
            "background_color": "#e6e6e6ff"
        },
        "text2": {
            "card_type": "TextCard",
            "region": {
                "x": 0.35,
                "y": -0.4,
                "w": 0.2,
                "h": 0.1,
                "mask": 'rectangle',
            },
            "text": "I am a TextCard2.",
            "font_size": 0.03,
            "justification_horizontal": "center",
            "justification_vertical": "center",
            "text_color": "#000000ff",
            "background_color": "#e6e6e6ff"
        },
        "submit-button": {
            "card_type": "TextCard",
            "region": {
                "x": 0.,
                "y": -0.4,
                "w": 0.2,
                "h": 0.05,
                "mask": 'rectangle',
            },
            "text": "Done",
            "font_size": 0.03,
            "justification_horizontal": "center",
            "justification_vertical": "center",
            "text_color": "#ffffffff",
            "background_color": "green"
        },
    }

    const compositeCard2 = {
        "card_type": "CompositeCard",
        "children": {
            'child-card-11':{
                "card_type": "TextCard",
                "region": {
                    "x": -0.4,
                    "y": -0.25,
                    "w": 0.2,
                    "h": 0.1,
                    "mask": 'rectangle',
                },
                "text": "I am a child of a CompositeCard.",
                "font_size": 0.01,
                "justification_horizontal": "center",
                "justification_vertical": "center",
                "text_color": "#000000ff",
                "background_color": "#e6e6e6ff"
            },
        }
    }

    const multiSelectSensor = {
        sensor_type: "MultiSelectSensor",
        choices: {
            "hello-image": {
                "card_type": "ImageCard",
                "region": {
                    "x": -0.1,
                    "y": 0,
                    "w": 0.4,
                    "h": 0.2,
                    "mask": 'rectangle',
                },
                "image": {
                    "sha256": 'yo',
                    "media_type": "image/png",
                    "locator": {
                        "locator_type": 'RelativePath',
                        "relative_path": "./assets/image/png/f66018c63e5de97a4a022f8d0da2083d44a842abcc27195b6cca13980a77dc7b.png"
                    }
                },
                "font_size": 0.03,
                "justification_horizontal": "center",
                "justification_vertical": "center",
                "text_color": "#000000ff",
                "background_color": "#e6e6e6ff"
            },
            "hello-text": {
                "card_type": "TextCard",
                "region": {
                    "x": -0.4,
                    "y": -0.4,
                    "w": 0.2,
                    "h": 0.1,
                    "mask": 'rectangle',
                },
                "text": "I am a TextCard.",
                "font_size": 0.03,
                "justification_horizontal": "center",
                "justification_vertical": "center",
                "text_color": "#000000ff",
                "background_color": "#e6e6e6ff"
            },
            "text2": {
                "card_type": "TextCard",
                "region": {
                    "x": 0.35,
                    "y": -0.4,
                    "w": 0.2,
                    "h": 0.1,
                    "mask": 'rectangle',
                },
                "text": "I am a TextCard2.",
                "font_size": 0.03,
                "justification_horizontal": "center",
                "justification_vertical": "center",
                "text_color": "#000000ff",
                "background_color": "#e6e6e6ff"
            },
            "choice3": compositeCard2,
        },
        min_selections: 2,
        max_selections: null,
        confirm_button: {
            "card_type": "TextCard",
            "region": {
                "x": 0.,
                "y": -0.4,
                "w": 0.2,
                "h": 0.05,
                "mask": 'rectangle',
            },
            "text": "Done",
            "font_size": 0.03,
            "justification_horizontal": "center",
            "justification_vertical": "center",
            "text_color": "#ffffffff",
            "background_color": "green"
        }
    }

    const selectSensor = {
        sensor_type: "SelectSensor",
        choices: {
            'my-first-choice': {
                "card_type": "TextCard",
                "region": {
                    "x": -0.4,
                    "y": -0.4,
                    "w": 0.2,
                    "h": 0.1,
                    "mask": 'rectangle',
                },
                "text": "I am a TextCard.",
                "font_size": 0.03,
                "justification_horizontal": "center",
                "justification_vertical": "center",
                "text_color": "#000000ff",
                "background_color": "#e6e6e6ff"
            }
        }
    }

    const freeTextEntrySensor = {
        "sensor_type": "FreeTextEntrySensor",
        "prompt": "I am a FreeTextEntrySensor.",
        "font_size": 0.02,
        "min_length": 1,
        "max_length": null,
        "region": {
            'x': 0,
            'y': 0.25,
            'w': 0.75,
            'h': 0.25,
            'mask':'rectangle',
        },
    }

    const productSensor = {
        "sensor_type": "ProductSensor",
        "children": {
            'child-sensor1': freeTextEntrySensor,
            //'child-sensor2': selectSensor,
            'select3': multiSelectSensor,
        }
    }

    const videoCard = {
        "card_type": "VideoCard",
        "region": {
            "x": 0.25,
            "y": 0.,
            "w": 0.2,
            "h": 0.2,
            "mask": 'ellipse',
        },
        "video": {
            "sha256": "3f224a8b6a7917ae1364cf2cc9daf7a5f7073bfe0fb5d9b638d8a6efc1c867f7",
            "media_type": "video/mp4",
            "locator": {
                "locator_type": "RelativePath",
                "relative_path": "assets/video/mp4/3f224a8b6a7917ae1364cf2cc9daf7a5f7073bfe0fb5d9b638d8a6efc1c867f7.mp4"
            }
        },
        "loop": false
    }
    const compositeCard = {
        "card_type": "CompositeCard",
        "children": {
            'child-card-1':videoCard
        }
    }

    let graph = {
        "start": "my-node",
        "nodes": {
            "my-node": {
                "stimulus": compositeCard,
                "sensor": productSensor,
                "board_color": "white",
                "show_pointer": true,
            },
        },
        "transitions": {},
        "nodekit_version": "0.1.0",
        'registers': {},
    }

    import {play} from '/src/main.ts';

    window.focus();

    window.onload = async () => {
        let trace = await play(
            graph,
            (event) => {
                // Avoid noise in the log
                if ("PointerSampledEvent" === event.event_type) {
                    return;
                }
                console.log(event);
            },
            true,
        )
    };
</script>

</body>
</html>
