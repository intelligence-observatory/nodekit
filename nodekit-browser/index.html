<!-- example.html -->
<!doctype html>
<html lang="en">
<head>
    <link rel="shortcut icon" href="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>NodeKit Browser</title>
</head>
<body>
<div id="app"></div>
<script type="module" src="src/main.ts"></script>
<script type="module">

    let graph={
        "start": "my-node",
        "nodes": {
            "my-node": {
                "timeout_msec": 400,
                "cards": {
                    //"video": {
                    //    "card_type": "VideoCard",
                    //    "x": 0.0,
                    //    "y": 0.0,
                    //    "w": 0.3,
                    //    "h": 0.3,
                    //    "video": {
                    //        "sha256": "3f224a8b6a7917ae1364cf2cc9daf7a5f7073bfe0fb5d9b638d8a6efc1c867f7",
                    //        "media_type": "video/mp4",
                    //        "locator": {
                    //            "locator_type": "RelativePath",
                    //            "relative_path": "assets/video/mp4/3f224a8b6a7917ae1364cf2cc9daf7a5f7073bfe0fb5d9b638d8a6efc1c867f7.mp4"
                    //        }
                    //    },
                    //    "muted": true,
                    //    "loop": false
                    //},
                    "hello-image": {
                        "card_type": "ImageCard",
                        "region":{
                            "x": 0,
                            "y": 0,
                            "w": 0.4,
                            "h": 0.2,
                            "mask": 'rectangle',
                        },
                        "image": {
                            "sha256": 'yo',
                            "media_type": "image/png",
                            "locator": {
                                "locator_type":'RelativePath',
                                "relative_path":"./assets/image/png/f66018c63e5de97a4a022f8d0da2083d44a842abcc27195b6cca13980a77dc7b.png"
                            }
                        },
                        "font_size": 0.03,
                        "justification_horizontal": "center",
                        "justification_vertical": "center",
                        "text_color": "#000000ff",
                        "background_color": "#e6e6e6ff"
                    },
                    "hello-text": {
                        "card_type": "TextCard",
                        "region":{
                            "x": -0.4,
                            "y": -0.4,
                            "w": 0.2,
                            "h": 0.1,
                            "mask": 'rectangle',
                        },
                        "text": "I am a TextCard.",
                        "font_size": 0.03,
                        "justification_horizontal": "center",
                        "justification_vertical": "center",
                        "text_color": "#000000ff",
                        "background_color": "#e6e6e6ff"
                    },
                    "text2": {
                        "card_type": "TextCard",
                        "region":{
                            "x": 0.35,
                            "y": -0.4,
                            "w": 0.2,
                            "h": 0.1,
                            "mask": 'rectangle',
                        },
                        "text": "I am a TextCard2.",
                        "font_size": 0.03,
                        "justification_horizontal": "center",
                        "justification_vertical": "center",
                        "text_color": "#000000ff",
                        "background_color": "#e6e6e6ff"
                    },
                },
                "sensors": {
                    "wait": {
                        "sensor_type": "WaitSensor",
                        "timeout_msec":500,
                    },
                    "clicky": {
                        "sensor_type": "SelectSensor",
                        "choices":["hello-text", 'text2', 'hello-image'],
                    },
                    "slider-test": {
                        "sensor_type": "SliderSensor",
                        "region":{
                            "x": 0.0,
                            "y": -0.25,
                            "w": 1,
                            "h": 0.05,
                            "mask": 'rectangle',
                        },
                        "num_bins": 7,
                        "initial_bin_index": 5,
                        "orientation": "horizontal",
                        "show_bin_markers": true,
                    },
                    "slider-test2": {
                        "sensor_type": "SliderSensor",
                        "region":{
                            "x": 0.0,
                            "y": -0.3,
                            "w": 1,
                            "h": 0.05,
                            "mask": 'rectangle',
                        },
                        "num_bins": 100,
                        "initial_bin_index": 25,
                        "orientation": "horizontal",
                        "show_bin_markers": false,
                    },
                    "slider-vertical": {
                        "sensor_type": "SliderSensor",
                        "region":{
                            "x": -0.25,
                            "y": 0,
                            "w": 0.1,
                            "h": 0.3,
                            "mask": 'rectangle',
                        },

                        "num_bins": 100,
                        "show_bin_markers": true,
                        "initial_bin_index": 80,
                        "orientation": "vertical"
                    },
                    "slider-vertical2": {
                        "sensor_type": "SliderSensor",
                        "region":{
                            "x": -0.4,
                            "y": 0,
                            "w": 0.1,
                            "h": 0.3,
                            "mask": 'rectangle',
                        },
                        "num_bins": 7,
                        "initial_bin_index": 2,
                        "show_bin_markers": true,
                        "orientation": "vertical"
                    },
                    "free-text-test": {
                        "sensor_type": "FreeTextEntrySensor",
                        "region": {
                            "x": 0.0,
                            "y": 0.4,
                            "w": 0.6,
                            "h": 0.2,
                            "mask": 'rectangle',
                            "z_index":0,
                        },
                        "prompt": "I am a FreeTextEntrySensor. Type into me...",
                        "font_size": 0.02,
                        "text_color": "#ce3a3a",
                        "background_color": "#ffffff",
                        "max_length": null,
                        "min_length": 2,
                    }
                },
                "effects": [],
                "board_color": "gray",
                "exit": {
                    'predicate_type': 'AllPredicate',
                    'items': '*'
                }
            },
            "my-node2": {
                "timeout_msec": 400,
                "cards": {
                    "hello-text": {
                        "card_type": "TextCard",
                        "region":{
                            "x": -0.4,
                            "y": -0.4,
                            "w": 0.2,
                            "h": 0.1,
                            "mask": 'rectangle',
                        },
                        "text": "I am a TextCard.",
                        "font_size": 0.03,
                        "justification_horizontal": "center",
                        "justification_vertical": "center",
                        "text_color": "#000000ff",
                        "background_color": "#e6e6e6ff"
                    },
                },
                "sensors": {
                    "slider-test": {
                        "sensor_type": "SliderSensor",
                        "region":{
                            "x": 0.0,
                            "y": -0.25,
                            "w": 1,
                            "h": 0.05,
                            "mask": 'rectangle',
                        },
                        "num_bins": 7,
                        "initial_bin_index": 5,
                        "orientation": "horizontal",
                        "show_bin_markers": true,
                    },
                    "slider-test2": {
                        "sensor_type": "SliderSensor",
                        "region":{
                            "x": 0.0,
                            "y": -0.3,
                            "w": 1,
                            "h": 0.05,
                            "mask": 'rectangle',
                        },
                        "num_bins": 100,
                        "initial_bin_index": 25,
                        "orientation": "horizontal",
                        "show_bin_markers": false,
                    },
                },
                "effects": [],
                "board_color": "gray",
                "exit": {
                    'predicate_type': 'RacePredicate',
                    'items': '*'
                }
            },
        },
        "transitions": {
            'my-node': [
                {
                    'when': {
                        'op': 'lit',
                        'value': true,
                    },
                    'to': 'my-node2',
                    'register_updates': {
                        'hello': {
                            'op': 'lit',
                            'value': 'world',
                        }
                    },
                }
            ]
        },
        "nodekit_version": "0.1.0",
        'registers': {},
    }

    import {play} from '/src/main.ts';

    window.focus();

    window.onload = async () => {
        // Add focus
        let trace = await play(
            graph,
            (event) => {
                if ("PointerSampledEvent" === event.event_type) {
                    return; // too much noise in the log
                }
                console.log(event);
            },
            [],
            true,
        )
        console.log(trace)
    };
</script>

</body>
</html>
